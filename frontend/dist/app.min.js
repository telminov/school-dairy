(function(){angular.module("schoolDairy",["ngResource","ngSanitize","ngRoute","ngAnimate","ui.bootstrap","toaster","swAuth","swUtils"]).config(function($routeProvider){return $routeProvider.when("/",{templateUrl:"src/app/controllers/main.html",controller:"MainCtrl",label:""}).when("/schedule/",{templateUrl:"src/app/controllers/schedule.html",controller:"ScheduleCtrl",label:"Расписание"}).when("/login/",{templateUrl:"src/app/controllers/login.html",controller:"AuthLoginCtrl",label:"Вход"}).when("/logout/",{templateUrl:"src/app/controllers/logout.html",controller:"AuthLogoutCtrl",label:"Выход"})}).config(function(authConfigProvider,config){return authConfigProvider.setSystemLabel("Дневник"),authConfigProvider.setServerAddress(config.serverAddress),authConfigProvider.setFreeUrls(["/","/schedule/"])}).config(function($httpProvider){return $httpProvider.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded"}).run(function($location,$rootScope,swTitle){return $rootScope.swTitle=swTitle,$rootScope.$on("$routeChangeSuccess",function(event,current){var baseTitle,ref;return baseTitle=(null!=(ref=current.$$route)?ref.label:void 0)||"",swTitle.setTitleBase(baseTitle),swTitle.setTitleStart(""),swTitle.setTitleEnd("")})})}).call(this),function(){angular.module("schoolDairy").config(function($httpProvider){return $httpProvider.interceptors.push("serverErrorInterceptor")}).factory("serverErrorInterceptor",function($location,$q,$log){return{responseError:function(response){return(0===response.status||response.status>=500&&response.status<=600)&&$log.error(response),$q.reject(response)}}})}.call(this),function(){angular.module("schoolDairy").constant("config",{serverAddress:"http://192.168.160.10:8000"})}.call(this),function(){angular.module("schoolDairy").controller("MainCtrl",function($scope,$location){return $location.path("/schedule/")})}.call(this),function(){angular.module("schoolDairy").controller("NavBarCtrl",function($scope,auth){return $scope.auth=auth})}.call(this),function(){angular.module("schoolDairy").controller("ScheduleCtrl",function($scope,$log,toaster,schedule,DayItem){return $scope.schedule=schedule,$scope.dayItems=DayItem.query(),$scope.loading=!0,schedule.load().then(function(){return $scope.loading=!1},function(response){return $scope.loading=!1,toaster.pop("error","Ошибка","Не удалось получить расписание занятий"),$log.error(response)})})}.call(this),function(){angular.module("schoolDairy").factory("DayItem",function($resource,config){var url;return url=config.serverAddress+"/day_item/:id/",$resource(url)})}.call(this),function(){angular.module("schoolDairy").service("schedule",function($http,config){this.days=[],this._items={},this.load=function(){var promise,url;return this.days.length=0,this._items={},url=config.serverAddress+"/get_schedule/",promise=$http.get(url),promise.then(function(_this){return function(response){var day,i,item,len,ref,results;for(ref=response.data.schedule,results=[],i=0,len=ref.length;len>i;i++)day=ref[i],_this.days.push(day),results.push(function(){var j,len1,ref1,results1;for(ref1=day.items,results1=[],j=0,len1=ref1.length;len1>j;j++)item=ref1[j],this._items[day.name]||(this._items[day.name]={}),results1.push(this._items[day.name][item.day_item.id]=item);return results1}.call(_this));return results}}(this)),promise},this.getItem=function(_this){return function(dayName,dayItem){var ref;return null!=(ref=_this._items[dayName])?ref[dayItem.id]:void 0}}(this)})}.call(this);